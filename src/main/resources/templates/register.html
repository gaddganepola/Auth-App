<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sign Up</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <style>
        body {
          background: linear-gradient(135deg, #74abe2, #5563de);
          height: 100vh;
          font-family: 'Segoe UI', sans-serif;
        }
        .card {
          border-radius: 1rem;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
          padding: 2rem;
        }
        .form-control {
          border-radius: 0.5rem;
          padding: 0.75rem;
        }
        .btn-primary {
          border-radius: 0.5rem;
          padding: 0.75rem;
          font-size: 1rem;
          font-weight: 500;
          transition: all 0.3s ease;
        }
        .btn-primary:hover {
          background-color: #4353d0;
          transform: translateY(-2px);
        }
        h3 {
          font-weight: 700;
          color: #333;
        }
        .form-label {
          font-weight: 500;
        }
        a {
          color: #4353d0;
          text-decoration: none;
        }
        a:hover {
          text-decoration: underline;
        }
        /* Message styles */
        #message {
          margin-bottom: 1rem;
          padding: 0.75rem 1rem;
          border-radius: 0.5rem;
          font-weight: 600;
          display: none; /* hidden by default */
        }
        #message.success {
          background-color: #d1e7dd;
          color: #0f5132;
          border: 1px solid #badbcc;
        }
        #message.error {
          background-color: #f8d7da;
          color: #842029;
          border: 1px solid #f5c2c7;
        }
    </style>
</head>
<body class="d-flex align-items-center justify-content-center">
<div class="card" style="width: 400px;">
    <h3 class="text-center mb-4">Create Your Account</h3>

    <div id="message"></div>

    <form id="signupForm">
        <div class="mb-3">
            <label class="form-label" for="username">Username</label>
            <input
                    type="text"
                    name="username"
                    id="username"
                    class="form-control"
                    placeholder="Enter username"
                    required
            />
        </div>
        <div class="mb-3">
            <label class="form-label" for="email">Email</label>
            <input
                    type="email"
                    name="email"
                    id="email"
                    class="form-control"
                    placeholder="Enter email"
                    required
            />
        </div>
        <div class="mb-3">
            <label class="form-label" for="password">Password</label>
            <input
                    type="password"
                    name="password"
                    id="password"
                    class="form-control"
                    placeholder="Enter password"
                    required
            />
        </div>
        <button type="submit" class="btn btn-primary w-100">Register</button>
    </form>

    <p class="mt-3 text-center">
        Already have an account? <a href="/login">Login here</a>
    </p>
</div>

<script>
    const messageDiv = document.getElementById('message');
    const form = document.getElementById('signupForm');

    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const data = {
        username: e.target.username.value,
        email: e.target.email.value,
        password: e.target.password.value,
      };

      // Clear previous messages
      messageDiv.style.display = 'none';
      messageDiv.textContent = '';
      messageDiv.className = '';

      fetch('/user', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      })
        .then((res) => {
          if (!res.ok) throw new Error('Signup failed');
          return res.json();
        })
        .then((data) => {
          messageDiv.textContent = 'Registered successfully! Login now.';
          messageDiv.className = 'success';
          messageDiv.style.display = 'block';

          // Redirect after 2 seconds
          setTimeout(() => {
            window.location.href = '/login';
          }, 2000);
        })
        .catch((err) => {
          console.error('Error:', err);
          messageDiv.textContent = 'Signup failed. Please try again.';
          messageDiv.className = 'error';
          messageDiv.style.display = 'block';
        });
    });
</script>
</body>
</html>
